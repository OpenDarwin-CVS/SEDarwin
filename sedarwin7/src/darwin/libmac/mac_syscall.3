.\" Copyright (c) 2005 SPARTA, Inc.
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd September 20, 2005
.Dt MAC_SYSCALL 3
.Os
.Sh NAME
.Nm mac_syscall
.Nd MAC Framework system call
.Sh LIBRARY
The MAC Framework Library (libmac, -lmac)
.Sh SYNOPSIS
.In sys/mac.h
.Ft int
.Fn mac_syscall "const char *policyname" "int call" "void *arg"
.Sh DESCRIPTION
The
.Fn mac_syscall
is an extensible interface that permits MAC Framework security policy
modules to add system call interfaces without requiring modifications 
the the kernel system call table.  The MAC Framework will forward the
call number and argument data to the named policy module.
.Sh RETURN VALUES
Policies must return 0 to indicates success.  A -1 return value
indicates an error, and an error code is stored in errno.  The errno
values are defined by the policy module implementation.
.Sh ERRORS
In addition to the policy-specific errors, the following errors may be
generated by the MAC Framework:
.Bl -tag -width Er
.It Bq Er ENOSYS
The specified policy is not present, or does not implement the
.Fn mac_syscall
policy entry point.
.It Bq Er EFAULT
A pointer argument points outside the process's allocated address space.
.Sh SEE ALSO
.Xr mac 3 ,
.Xr mac 4
